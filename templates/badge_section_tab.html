<table class="table table-hover">
  <thead>
    <tr>
      <th>Student Name</th>
      <th>Course Section</th>
      <th>Badge Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    {% for registration in registrations %}
      {% if (registration.section == current_section) or (current_section == 'all') %}
        {% if registration.status == 'approved' %}
          {% set student = registration.student %}
          {% set current_achievement_status = achievement_status(student, badge, teacher, course.course) %}
            <tr>
              <td>
                <a href="/student_badge/{{student.key.id()}}/{{course.course.key.id()}}/{{badge.key.id()}}/teacher_view">
                  {{student.formalName}}
                </a>
              </td>
              <td>{{registration.section}}</td>
              <td>
                {% if 'awarded' in current_achievement_status %}
                  <span class="text-success"><i class="icon-certificate"></i> awarded</span>
                {% elif 'revoked' in current_achievement_status %}
                  <span class="text-danger"><i class="icon-exclamation-sign"></i> you revoked this badge</span>
                {% elif 'requested' in current_achievement_status %}
                  <span class="text-warning"><i class="icon-exclamation-sign"></i> student has requested badge</span>
                {% elif 'denied' in current_achievement_status %}
                  <span class="text-danger"><i class="icon-exclamation-sign"></i> you denied student request</span>
                {% else %}
                  <span class="text-muted">not yet obtained</span>
                {% endif %}
              </td>
              <td>
                {% if current_achievement_status != 'awarded' %}
                  <a class="btn-loading btn btn-success btn-small" href="/student_badge/{{student.key.id()}}/{{course.course.key.id()}}/{{badge.key.id()}}/teacher_view/award/awarded?single_badge=true&active_section={{current_section}}">award</a>
                  {% if current_achievement_status == 'requested' %}
                    <a class="btn-loading btn btn-danger btn-small" href="/student_badge/{{student.key.id()}}/{{course.course.key.id()}}/{{badge.key.id()}}/teacher_view/award/denied?single_badge=true&active_section={{current_section}}">deny</a>
                  {% endif %}
                {% else %}
                  <a class="btn-loading btn btn-warning btn-small" href="/student_badge/{{student.key.id()}}/{{course.course.key.id()}}/{{badge.key.id()}}/teacher_view/award/revoked?single_badge=true&active_section={{current_section}}">revoke</a>
                {% endif %}
              </td>
            </tr>
        {% endif %}
      {% endif %}
    {% endfor %}
  </tbody>
</table>