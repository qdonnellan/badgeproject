{% extends 'user_base.html' %}


{% block body %}
<div>
  <div class="row">
    <div class="page-header">
    <h1>{{checkpoint.name}}</h1>
    <p class="text-muted">Checkpoint for the course <a href="/course/{{courseID}}">{{course.name}}</a></p>
    </div>
    
    <p class="lead">{{checkpoint.description}}</p>
    <p><a class="btn btn-info btn-small" href="/course/{{courseID}}/edit_checkpoint/{{checkpoint.checkpoint.key.id()}}">Edit Checkpoint</a></p>
    <hr>
  </div>
  <table class="table table-hover row">
    <thead>
      <tr>
        <th>Student Name</th>
        <th class="hidden-sm">Badge Progress</th>
        <th class="hidden-sm">Percent Completion</th>
      </tr>
    </thead>
    <tbody>
      {% for student in course.enrolled_students %}
        {% set student_checkpoint = get_cached_checkpoint(checkpoint.checkpoint, student.key.id()) %}
      <tr>
        <td>
          <a href="/student_profile/{{student.key.id()}}/{{courseID}}/teacher_view">{{student.formalName}}</a> 
          <h4 class="pull-right visible-sm">{{student_checkpoint.percent_complete}}%</h4>
          <div class="visible-sm">
            {% for badge in student_checkpoint.badges %}
                <a href="/student_badge/{{student.key.id()}}/{{courseID}}/{{badge.badge.key.id()}}/teacher_view">
                  {% if badge.status == 'awarded' %}
                    <div class="tiny-badge pull-left">
                      <div class="badge-new" style="background: {{badge.background}}; color: {{badge.icon_color}}">
                        <div class="badge-icon-container"><i class="icon-{{badge.icon}}"></i></div>
                      </div>
                    </div>
                  {% else %}
                    <div class="tiny-badge pull-left">
                      <div class="badge-grey badge-new">
                        <div class="badge-icon-container"><i class="icon-{{badge.icon}}"></i></div>
                      </div>
                    </div>
                  {% endif %}
                </a>
            {% endfor %}
          </div>
        </td>

        <td class="hidden-sm">
          {% for badge in student_checkpoint.badges %}
            <a href="/student_badge/{{student.key.id()}}/{{courseID}}/{{badge.badge.key.id()}}/teacher_view">
              {% if badge.status == 'awarded' %}
                <div class="tiny-badge pull-left">
                  <div class="badge-new" style="background: {{badge.background}}; color: {{badge.icon_color}}">
                    <div class="badge-icon-container"><i class="icon-{{badge.icon}}"></i></div>
                  </div>
                </div>
              {% else %}
                <div class="tiny-badge pull-left">
                  <div class="badge-grey badge-new">
                    <div class="badge-icon-container"><i class="icon-{{badge.icon}}"></i></div>
                  </div>
                </div>
              {% endif %}
            </a>
          {% endfor %}
        </td>
        <td class="hidden-sm"><h4>{{student_checkpoint.percent_complete}}%</h4></td>

      </tr>
      
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}